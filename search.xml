<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>二进制代码学习作业中的CTF题目</title>
      <link href="/2024/11/03/%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BD%BF%E7%94%A8%E5%88%86%E6%9E%90CH5/"/>
      <url>/2024/11/03/%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BD%BF%E7%94%A8%E5%88%86%E6%9E%90CH5/</url>
      
        <content type="html"><![CDATA[<h2 id="A-New-CTF-Challenge"><a href="#A-New-CTF-Challenge" class="headerlink" title="A New CTF Challenge"></a>A New CTF Challenge</h2><h3 id="lvl2"><a href="#lvl2" class="headerlink" title="lvl2"></a>lvl2</h3><p>由oracle得到了lvl2，先查看一下</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106212946.png" alt="image-20241103204645257"></p><p>同时发现运行不了lvl2，于是给予权限</p><p><code>chmod +777 lvl2</code></p><p>此时尝试运行文件会输出两个字符，由数字或字母组成</p><p>hint中给出了关键信息<strong>combine</strong>，同时由第一阶段的flag猜测，本阶段的flag是由输出给出的字符结合组成</p><p>因此objdump查看</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106213114.png" alt="image-20241103205102540"></p><p>后面部分结合起来得到flag：034fc4f6a536f2bf74f8d6d3816cdf88</p><h3 id="lvl3"><a href="#lvl3" class="headerlink" title="lvl3"></a>lvl3</h3><p>这次给的hint是 <strong>fix four broken things</strong>，先查看lvl3本身</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106212457.png" alt="image-20241103213345582"></p><p>发现了几个异常</p><p><em>OS&#x2F;ABI字段是”Novell - Modesto”，而不是之前的”Unix - System V”</em></p><p><em>Machine字段是”Motorola Coldfire”，而不是常见的机器类型</em></p><p><em>程序头的大小大于了文件本身的大小</em></p><p>直接运行文件会有如下问题</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106213139.png" alt="image-20241103214120468"></p><p>使用xdd把lvl3直接copy到txt中，vim进行查看</p><p>发现了之前提到的错误</p><p>!<img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106213249.png" alt="image-20241103234318547"></p><p>进行修改得到如上。现在尝试运行，得到一个结果</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106213326.png" alt="image-20241103234358227"></p><p>但是这个结果是错误的，因为hint说过，有四个错误，但是实际上我们只修改了3个</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106213412.png" alt="image-20241103234528625"></p><p>后续检查发现了section.text的内容缺失</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106213459.png" alt="image-20241103235532006"></p><p>那么，求出偏移量为5380</p><p>可以继续修改在0x1500行，将0800改成0100，可以得到结果</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106220458.png" alt="image-20241103235834077"></p><h3 id="lvl4"><a href="#lvl4" class="headerlink" title="lvl4"></a>lvl4</h3><p>粗览信息</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106220657.png" alt="image-20241104002548731"></p><p>可以大概明白核心函数</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106220733.png" alt="image-20241104003112612"></p><p>发现关键词FLAG，即<strong>XaDht-+1432&#x3D;&#x2F;as4?0129mklqt!@cnz^</strong></p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106220759.png" alt="image-20241104003229425"></p><p>很轻松得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106220818.png" alt="image-20241104003303882"></p><h3 id="lvl5"><a href="#lvl5" class="headerlink" title="lvl5"></a>lvl5</h3><p>先查看一下strings</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106221053.png" alt="image-20241104132307884"></p><p>发现了flag，所以尝试ltrace一下</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106221111.png" alt="image-20241104132405096"></p><p>因此，我们需要gdb动态调试到函数入口看看具体的情况</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106221137.png" alt="image-20241104132739825"></p><p>在0x40053d中，函数开头会被传递给**__libc_start_main**，于是我们在这进行更改，使其到我们想去的地址</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106221200.png" alt="image-20241104133042351"></p><p>不过得到的是乱码</p><p><strong>观察rax中每个字节都会跟ebx的内容进行xor</strong></p><p>因此继续重写ebx中的内容，即可让他输出原来的值</p><p><img src="https://cdn.jsdelivr.net/gh/Angek0k/myimg@master/20241106221220.png" alt="image-20241104133737432"></p><p>即可得到flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>博客简介</title>
      <link href="/2024/11/02/%E5%8D%9A%E5%AE%A2%E7%AE%80%E4%BB%8B/"/>
      <url>/2024/11/02/%E5%8D%9A%E5%AE%A2%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="个人简介"><a href="#个人简介" class="headerlink" title="个人简介"></a>个人简介</h2><p>男，SEU在读，fps爱好者</p><h2 id="别再视奸"><a href="#别再视奸" class="headerlink" title="别再视奸"></a>别再视奸</h2><p>这个博客主要用于记录本人学习过程中的知识记录和一些杂项的记载，便于本人的归纳整理和后续阅读<br>后续会继续更新分类标签和其他事项<br><img src="/./img/%E6%88%91%E4%BC%9A%E8%A7%86%E5%A5%B8.jpg" alt="我会一直视奸你的"></p><h2 id="可能更新的内容"><a href="#可能更新的内容" class="headerlink" title="可能更新的内容"></a>可能更新的内容</h2><p>后续可能更新的方向大概在CTF、LLM的学习，课程内的学习和论文的阅读以及项目记录</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
